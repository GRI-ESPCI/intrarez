<div class="card p-card bg-pc5 border-pc4 border-2 h-100">
    <div class="card-body d-flex align-items-center mb-2">
        <h3 class="card-title me-auto my-0">{{ _("Appareils") }}</h3>
            <svg class="bi flex-shrink-0" width="36" height="36"
                 role="img">{{ bootstrap_icon("laptop") }}
            </svg>
    </div>
    <table class="table table-striped table-borderless"><tbody>
        {% with device = user.current_device %}
        <tr><th scope="row" class="ps-4">{{ _("Appareil actuel") }}</th>
            <td class="text-break">{{ device.name }}
            </td></tr>
        <tr><th scope="row" class="ps-4">{{ _("Type") }}</th>
            <td class="text-break">{{ device.type }}
            </td></tr>
        <tr><th scope="row" class="ps-4">{{ _("Adresse MAC") }}</th>
            <td class="text-break">{{ device.mac_address }}
            </td></tr>
        <tr><th scope="row" class="ps-4">{{ _("Enregistrement") }}</th>
            <td class="text-break">
                <span title="{{ device.registered }} UTC">
                    {{ moment(device.registered).format("LL") }}
                </span>
            </td></tr>
        {% endwith %}
    </tbody></table>
    <div class="card-body h-100"><div class="accordion" id="acco-dev">
        <div class="accordion-item">
            <h3 class="accordion-header" id="acco-dev-h">
                <button class="accordion-button collapsed bg-pc5 text-dark"
                        type="button" data-bs-toggle="collapse"
                        data-bs-target="#coll-dev-h"
                        aria-expanded="true" aria-controls="coll-dev-h">
                    {{ _("Autres appareils :") }}&nbsp;<strong>
                    {{ len(user.other_devices) }}</strong>
                </button>
            </h3>
            <div id="coll-dev-h" class="accordion-collapse collapse"
                 aria-labelledby="acco-dev-h"
                 data-bs-parent="#acco-dev">
                <div class="accordion-body bg-pc5 p-0">
                    {% if user.other_devices %}
                    <table class="table table-striped table-borderless
                                  mb-0"><tbody>
                        <tr><th scope="col" class="ps-3">
                                {{ _("Nom") }}
                            </th>
                            <th scope="col" colspan=2>
                                {{ _("Dernière connexion") }}
                            </th>
                        </tr>
                        {% for device in user.other_devices %}
                        <tr class="align-middle">
                            <td class="text-break ps-3">
                                {{ device.name }}
                            </td>
                            <td>
                               {% if device.last_seen %}
                               <span title="{{ device.last_seen }} UTC">
                                   {{ moment(device.last_seen).fromNow() }}
                               </span>
                               {% else %}
                               <span>{{ _("Jamais") }}</span>
                               {% endif %}
                            </td>
                            <td class="text-end">
                                <button type="button" class="btn p-0 me-1"
                                        data-bs-target="#mo-device-{{ user.id }}-{{ device.id }}"
                                        data-bs-toggle="modal">
                                <svg class="bi flex-shrink-0" width="24"
                                     height="24" role="img"
                                     aria-label="{{ _("Détails") }}">
                                    {{ bootstrap_icon("eye") }}
                                </svg>
                            </button></td>
                        </tr>
                        {% endfor %}
                    </tbody></table>
                    {% endif %}
                </div>
            </div>
        </div>
    </div></div>
    <div class="card-body px-auto">
        <div class="d-inline-block me-3 mb-2" data-bs-toggle="tooltip"
             data-bs-placement="top"
             title="{{ _("Fonctionnalité à venir") }}">
            <button class="btn btn-outline-dark" disabled>
                {{ _("Modifier l'appareil") }}
            </button>
        </div>
        <a class="btn btn-outline-dark"
           href="{{ url_for("devices.register", force=True,
                            next=request.url_rule.endpoint) }}">
            {{ _("Nouvel appareil") }}
        </a>
    </div>
</div>
